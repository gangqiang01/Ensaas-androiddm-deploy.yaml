webpackJsonp([31],{"4RBl":function(t,e){},"6akw":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),l=i.n(a),s=i("jwu5"),o=i("jnx8"),n=i("YMj5"),r={name:"containerMonitor",data:function(){return{formLabelWidth:"150px",servicename:"",selectedAgentId:"",serviceTaskData:[],serviceId:"",createdTime:"",lastUpdateTime:"",replicas:0,schedulingMode:"",image:"",loading:!1,inputImage:"",logLoading:!1,inspectDialogVisible:!1,logDialogVisible:!1,content:"",inspectContent:""}},methods:{getContent:function(t,e){var i=this;this.content="","getServiceLog"==t?this.logDialogVisible=!0:this.inspectDialogVisible=!0;var a={};a.id=e.id,this.logLoading=!0,Object(n.e)(this.selectedAgentId,s.h[t],a).then(function(e){i.logLoading=!1,Object(o.a)(e,function(e){"CONTENT"==e.status&&("getServiceLog"==t?i.content=e.content.value:i.inspectContent=JSON.parse(e.content.value))})})},editorInit:function(){i("aDfU"),i("sYys"),i("hww6"),i("y9Ym"),i("J4HJ"),i("2LVu")},getServiceDetails:function(t){var e=this,i={};this.selectedAgentId?(i.id=t,this.loading=!0,Object(n.e)(this.selectedAgentId,s.h.getServiceDetails,i).then(function(t){e.loading=!1,Object(o.a)(t,function(t){if("CONTENT"==t.status){var i=JSON.parse(t.content.value);e.serviceId=i.id,e.lastUpdateTime=i.lastupdate,e.createdTime=i.createat,e.image=i.image;var a=i.image.split("@");e.inputImage=a[0],e.replicas=i.replicas,e.schedulingMode=i.schedulingmode,e.serviceTaskData=i.taskinfos}})})):console.error("agentId is empty")},refreshTask:function(){this.getServiceDetails(this.serviceId)},actionContainerSensor:function(t){var e=this;if(void 0!==s.h[t])if(""!=this.selectedAgentId){var i={};"updateServiceReplicas"==t?(i.serviceId=this.serviceId,i.replicas=this.replicas):"updateServiceImage"==t&&(i.serviceId=this.serviceId,i.image=this.inputImage),_g.swalWarnDo(this.$t("global.areYouSure"),this.$t("dockerAction."+t),this.$t("global.confirm"),this.$t("global.cancel")).then(function(a){a&&(_g.openGlobalLoading(),Object(n.h)(e.selectedAgentId,s.h[t],l()(i),!0).then(function(t){Object(o.a)(t,function(t){"CHANGED"==t.status?e.$swal("",e.$t("global.success"),"success",{button:e.$t("global.confirm")}).then(function(){e.getServiceDetails(e.serviceId)}):_g.handleError(t)})}))})}else this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")});else this.$swal("",this.$t("global.functionNotSupport"),"info",{button:this.$t("global.confirm")})},back:function(){this.$router.go(-1)}},components:{editor:i("xds+")},created:function(){this.$route.query.name&&this.$route.query.endpoint&&(this.servicename=this.$route.query.name,this.selectedAgentId=this.$route.query.endpoint,this.serviceId=this.$route.query.serviceId,this.getServiceDetails(this.serviceId))}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"title"},[i("p",{staticClass:"header-line"},[i("i",{staticClass:"fa fa-arrow-left m-r-10 pointer",attrs:{"aria-hidden":"true"},on:{click:function(e){t.back()}}}),t._v("\n            "+t._s(t.servicename)+"\n        ")])]),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-card m-t-20"},[i("el-form",[i("el-form-item",{attrs:{label:t.$t("label.name"),"label-width":t.formLabelWidth}},[i("span",{staticClass:"label-value"},[t._v(t._s(t.servicename))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.id"),"label-width":t.formLabelWidth}},[i("span",[t._v(t._s(t.serviceId))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.createdTime"),"label-width":t.formLabelWidth}},[i("span",[t._v(t._s(t.createdTime))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.lastUpdateTime"),"label-width":t.formLabelWidth}},[i("span",[t._v(t._s(t.lastUpdateTime))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.schedulingMode"),"label-width":t.formLabelWidth}},[i("span",[t._v(t._s(t.schedulingMode))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.image"),"label-width":t.formLabelWidth,prop:"image"}},[i("span",[t._v(t._s(t.image))])]),t._v(" "),i("el-form-item",{attrs:{label:t.$t("label.replicas"),"label-width":t.formLabelWidth}},[i("el-input-number",{staticClass:"w-200",attrs:{size:"small","controls-position":"right",min:1,max:10,disabled:"Replicated"!=t.schedulingMode},model:{value:t.replicas,callback:function(e){t.replicas=e},expression:"replicas"}})],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth}},[i("el-button",{attrs:{type:"primary",size:"small",disabled:"Replicated"!=t.schedulingMode},on:{click:function(e){t.actionContainerSensor("updateServiceReplicas")}}},[t._v(t._s(t.$t("global.apply")))])],1)],1)],1),t._v(" "),i("p",{staticClass:"header-line m-t-20"},[i("i",{staticClass:"fa fa-clone m-r-10 pointer c-primary",attrs:{"aria-hidden":"true"}}),t._v("\n        "+t._s(t.$t("dockerControl.updataImage"))+"\n    ")]),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-card m-t-20 p-t-20"},[i("el-form",[i("el-form-item",{attrs:{label:t.$t("label.image"),"label-width":t.formLabelWidth,prop:"image"}},[i("el-input",{staticClass:"w-500",attrs:{autocomplete:"off",placeholder:t.$t("dockerControl.imageHolder")},model:{value:t.inputImage,callback:function(e){t.inputImage="string"==typeof e?e.trim():e},expression:"inputImage"}}),t._v(" "),i("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:t.$t("dockerControl.imageTooltip"),placement:"top-start"}},[i("i",{staticClass:"fa fa-question-circle tooltip",attrs:{"aria-hidden":"true"}})])],1),t._v(" "),i("el-form-item",{attrs:{"label-width":t.formLabelWidth}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.actionContainerSensor("updateServiceImage")}}},[t._v(t._s(t.$t("global.apply")))])],1)],1)],1),t._v(" "),i("p",{staticClass:"header-line m-t-20"},[i("i",{staticClass:"fa fa-tasks m-r-10 pointer c-primary",attrs:{"aria-hidden":"true"}}),t._v("\n        "+t._s(t.$t("dockerControl.tasks"))+"\n        "),i("i",{staticClass:"fa fa-refresh m-l-10 c-primary pointer",attrs:{"aria-hidden":"true"},on:{click:function(e){t.refreshTask()}}})]),t._v(" "),i("div",{staticClass:"box-card m-t-20"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.serviceTaskData,"tooltip-effect":"dark"}},[i("el-table-column",{attrs:{prop:"name",label:t.$t("dockerControl.name"),"min-width":"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"state",label:t.$t("dockerControl.state"),"min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",["running"==e.row.state?i("span",{staticClass:"badge bg-green"},[t._v(t._s(e.row.state))]):"failed"==e.row.state?i("span",{staticClass:"badge bg-red"},[t._v(t._s(e.row.state))]):"complete"==e.row.state?i("span",{staticClass:"badge bg-aqua"},[t._v(t._s(e.row.state))]):i("span",{staticClass:"badge bg-SteelBlue"},[t._v(t._s(e.row.state))])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"nodeid",label:"Node","min-width":"100"}}),t._v(" "),i("el-table-column",{attrs:{label:t.$t("dockerControl.quickAction"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[i("el-tooltip",{attrs:{content:"Log",placement:"top"}},[i("i",{staticClass:"fa fa-file-text m-r-5 c-primary pointer",attrs:{"aria-hidden":"true"},on:{click:function(i){t.getContent("getServiceLog",e.row)}}})]),t._v(" "),i("el-tooltip",{attrs:{content:"Inspect",placement:"top"}},[i("i",{staticClass:"fa fa-info-circle m-r-5 c-primary pointer",attrs:{"aria-hidden":"true"},on:{click:function(i){t.getContent("getServiceInspect",e.row)}}})])],1)]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"updatedat",label:t.$t("dockerControl.lastupdate"),"min-width":"100"}})],1),t._v(" "),i("el-dialog",{attrs:{visible:t.logDialogVisible},on:{"update:visible":function(e){t.logDialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fa fa-file-text m-r-10",attrs:{"aria-hidden":"true"}}),t._v("\n                Log\n            ")]),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.logLoading,expression:"logLoading"}],staticClass:"text-center"},[i("editor",{attrs:{lang:"html",theme:"chrome",height:"550",options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,tabSize:2,fontSize:14,showPrintMargin:!1}},on:{init:t.editorInit},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.logDialogVisible=!1}}},[t._v(t._s(t.$t("global.cancel")))])],1)]),t._v(" "),i("el-dialog",{attrs:{visible:t.inspectDialogVisible},on:{"update:visible":function(e){t.inspectDialogVisible=e}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("i",{staticClass:"fa fa-info-circle m-r-10",attrs:{"aria-hidden":"true"}}),t._v("\n                Inspect\n            ")]),t._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.logLoading,expression:"logLoading"}]},[i("tree-view",{attrs:{data:t.inspectContent,options:{maxDepth:5}}})],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(e){t.inspectDialogVisible=!1}}},[t._v(t._s(t.$t("global.cancel")))])],1)])],1)])},staticRenderFns:[]};var d=i("C7Lr")(r,c,!1,function(t){i("4RBl")},"data-v-75df4fe0",null);e.default=d.exports}});
//# sourceMappingURL=31.2e513c6bf69874a4bd11.js.map