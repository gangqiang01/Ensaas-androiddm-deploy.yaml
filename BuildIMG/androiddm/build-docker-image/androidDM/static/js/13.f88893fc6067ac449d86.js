webpackJsonp([13],{V3KR:function(t,e){},bEks:function(t,e){},mPQc:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("42+z"),i=a("FM1y"),s=a("HvBW"),o=a("jwu5"),l=a("jnx8"),r=a("YMj5"),u=a("uZZm"),c=a("22O3"),p=a("/eZD"),d=a("UuJD"),g={name:"linuxPkgControlHistory",data:function(){return{pkgStatusHistoryTableList:[],isshow:!1,limit:10,dataCount:0,currentPage:1,multipleSelection:[],isShowBtnGroup:!1,clearLoading:!1,batchDeleteAppStatusHistory:d.a,intervalTime:7e3,isInterval:!1,listLoading:!1,singleDebType:p.E,batchDebType:p.g,statusArray:[]}},components:{btnGroup:a("C+p8").a},props:{statusType:{default:p.g,type:String},selectedAgentId:{default:"",type:String},groupname:{default:"",type:String}},methods:{selectItem:function(t){this.multipleSelection=t},checkSelectable:function(t){return 0==!t.status},handleCurrentChange:function(t){this.currentPage=t||1,this.intervalGetPkgStatusHistory()},deleteHistory:function(t){var e=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("global.delete"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(a){a&&(e.listLoading=!0,Object(d.d)(t).then(function(t){e.listLoading=!1,Object(l.a)(t,function(t){"CHANGED"===t.status?e.$swal("",e.$t("global.success"),"success",{button:e.$t("global.confirm")}).then(function(){e.intervalGetPkgStatusHistory()}):_g.handleError(t)})}))})},checkAppStatusData:function(){this.statusType==p.g?Object(d.f)(this.groupname,this.statusType):Object(d.e)(this.selectedAgentId,this.statusType)},getAppStatusHistoryByGroupname:function(){var t=this;this.groupname||console.error("[getAppStatusHistoryByGroupname]groupname is empty"),!1===this.isInterval&&(this.listLoading=!0),this.statusArray.length>0?Object(d.h)(this.groupname,this.statusType,this.currentPage,this.limit,this.statusArray).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignAppStatusData(e)})}):Object(d.j)(this.groupname,this.statusType,this.currentPage,this.limit).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignAppStatusData(e)})})},getAppStatusHistoryBydevid:function(){var t=this;this.selectedAgentId||console.error("[getAppStatusHistoryBydevid]selectedAgentId is empty"),!1===this.isInterval&&(this.listLoading=!0),this.statusArray.length>0?Object(d.g)(this.selectedAgentId,this.statusType,this.currentPage,this.limit,this.statusArray).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignAppStatusData(e)})}):Object(d.i)(this.selectedAgentId,this.statusType,this.currentPage,this.limit).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignAppStatusData(e)})})},assignAppStatusData:function(t){if("[object Object]"===Object.prototype.toString.call(t)&&"[object Array]"===Object.prototype.toString.call(t.data)){this.dataCount=t.count,this.pkgStatusHistoryTableList=t.data,this.isshow=this.dataCount>this.limit,this.isShowBtnGroup=this.dataCount>0;var e=!0;this.statusType==p.g&&this.$emit("getStatusCount"),t.data.forEach(function(t){0==t.status&&(e=!1)}),e&&(this.$emit("isFinished"),window.clearInterval(_g.timer),_g.timer=null)}else window.clearInterval(_g.timer),_g.timer=null},intervalGetPkgStatusHistory:function(){var t=this;this.statusType==p.g?(this.getAppStatusHistoryByGroupname(),null===_g.timer&&(_g.timer=window.setInterval(function(){t.getAppStatusHistoryByGroupname(),t.isInterval=!0},this.intervalTime))):(this.getAppStatusHistoryBydevid(),null===_g.timer&&(_g.timer=window.setInterval(function(){t.getAppStatusHistoryBydevid(),t.isInterval=!0},this.intervalTime)))},filterStatus:function(t){this.statusArray=t.status,this.currentPage=1,_g.isArray(this.statusArray)&&this.intervalGetPkgStatusHistory()},resetAppSensor:function(t,e,a){var n=this;this.listLoading=!0,Object(r.g)(e,t,a).then(function(t){n.listLoading=!1,Object(l.a)(t,function(t){"CHANGED"==t.status?(n.activeName="appStatusHistory",n.currentPage=1,n.intervalGetPkgStatusHistory()):_g.handleError(t)})})},reinstall:function(t){var e=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("linuxPkgControl.repeat"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(a){if(a){var n={taskname:t.taskname,productname:t.pkgname,version:t.versionname,downloadpath:t.address,type:t.type};e.resetAppSensor(t.target,t.deviceId,n)}})},isSuccess:function(t){t&&this.intervalGetPkgStatusHistory()},clearAll:function(){var t=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("global.clearAll"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(e){e&&(t.clearLoading=!0,t.statusType==p.g?Object(d.c)(t.groupname,t.statusType).then(function(e){t.clearLoading=!1,Object(l.a)(e,function(e){"CHANGED"===e.status?t.$swal("",t.$t("global.success"),"success",{button:t.$t("global.confirm")}).then(function(){t.intervalGetPkgStatusHistory()}):_g.handleError(e)})}):Object(d.b)(t.selectedAgentId,t.statusType).then(function(e){t.clearLoading=!1,Object(l.a)(e,function(e){"CHANGED"===e.status?t.$swal("",t.$t("global.success"),"success",{button:t.$t("global.confirm")}).then(function(){t.intervalGetPkgStatusHistory()}):_g.handleError(e)})}))})},initData:function(){this.pkgStatusHistoryTableList=[],this.isShowBtnGroup=!1,this.isshow=!1,this.isInterval=!1,this.currentPage=1}},created:function(){this.statusType==p.g&&this.$emit("getStatusCount")},beforeDestroy:function(){window.clearInterval(_g.timer),_g.timer=null},watch:{groupname:function(t){t&&(this.initData(),this.checkAppStatusData(),this.intervalGetPkgStatusHistory())},selectedAgentId:function(t){t&&(this.initData(),this.checkAppStatusData(),this.intervalGetPkgStatusHistory())}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"pkgStatusHistoryTable",staticStyle:{width:"100%"},attrs:{data:t.pkgStatusHistoryTableList,"tooltip-effect":"dark","default-sort":{prop:"ts",order:"descending"},"header-cell-style":{background:"#fafafa",color:"#606266"}},on:{"selection-change":t.selectItem,"filter-change":t.filterStatus}},[n("el-table-column",{attrs:{type:"selection","min-width":"50",selectable:t.checkSelectable}}),t._v(" "),n("el-table-column",{attrs:{prop:"devname",label:t.$t("linuxPkgControl.deviceName"),"min-width":"120"}}),t._v(" "),t.statusType==t.batchDebType?n("el-table-column",{attrs:{prop:"taskname",label:t.$t("linuxPkgControl.taskName"),"min-width":"120"}}):t._e(),t._v(" "),n("el-table-column",{attrs:{prop:"pkgname",label:t.$t("linuxPkgControl.productName"),"min-width":"140"}}),t._v(" "),n("el-table-column",{attrs:{prop:"versionname",label:t.$t("linuxPkgControl.version"),"min-width":"100"}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("linuxPkgControl.beginTime"),"min-width":"130",prop:"ts"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("time")(e.row.ts))+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"target",label:t.$t("linuxPkgControl.function"),"min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("appStatusFunction")(e.row.target))+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{"column-key":"status",prop:"status",label:t.$t("linuxPkgControl.installStatus"),"min-width":"140",filters:[{text:t.$t("global.success"),value:2},{text:t.$t("global.failed"),value:1},{text:t.$t("global.running"),value:0}],"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?n("img",{staticStyle:{width:"50px",height:"10px"},attrs:{src:a("PLes"),alt:""}}):t._e(),t._v(" "),2==e.row.status?n("span",{staticClass:"badge bg-green"},[t._v(t._s(t.$t("global.success")))]):t._e(),t._v(" "),1==e.row.status?n("span",{staticClass:"badge bg-DimGray"},[t._v(t._s(t.$t("global.failed")))]):t._e()]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("linuxPkgControl.errorStatus"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("appErrorStatus")(""+e.row.errorcode))+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("linuxPkgControl.action"),"min-width":"175",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("el-button-group",[n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.deleteHistory(e.row.aisid)}}},[t._v("\n                                "+t._s(t.$t("global.delete"))+"\n                        ")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"primary",disabled:1!=e.row.status},on:{click:function(a){t.reinstall(e.row)}}},[t._v("\n                                "+t._s(t.$t("linuxPkgControl.repeat"))+"\n                        ")])],1)],1)]}}])})],1),t._v(" "),n("btn-group",{directives:[{name:"show",rawName:"v-show",value:t.isShowBtnGroup,expression:"isShowBtnGroup"}],staticClass:"fl m-t-10 cf",attrs:{selectedData:t.multipleSelection,isDelete:!0,isMove:!1,tid:"aisid",delApi:t.batchDeleteAppStatusHistory},on:{result:t.isSuccess}}),t._v(" "),n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.clearLoading,expression:"clearLoading"},{name:"show",rawName:"v-show",value:t.isShowBtnGroup,expression:"isShowBtnGroup"}],staticClass:"fl m-t-10 cf m-l-10",attrs:{size:"small",type:"primary"},on:{click:function(e){t.clearAll()}}},[t._v("\n    "+t._s(t.$t("linuxPkgControl.clearAll"))+"\n    ")]),t._v(" "),n("div",{staticClass:"m-t-10 cf fr"},[n("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.isshow,expression:"isshow"}],attrs:{layout:"prev, pager, next","page-size":t.limit,"current-page":t.currentPage,total:t.dataCount,background:""},on:{"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var h=a("C7Lr")(g,f,!1,function(t){a("xKvL")},"data-v-54839d92",null).exports,m={name:"singlelinuxPkgControl",data:function(){return{activeName:"linuxMarket",pkgTableData:[],defaultImg:'this.src="static/imgs/linux_package.png"',singleDebType:p.E,listLoading:!1,keywords:""}},props:{selectedAgentId:{type:String,default:""},isSingleMode:{type:Boolean,default:!0},isOffline:{type:Boolean,default:!1}},components:{pkgHistory:h},methods:{getSensorStatus:function(){var t=this;if(this.isSingleMode)if(""!=this.selectedAgentId){var e=[],a=[];this.listLoading=!0,Object(r.e)(this.selectedAgentId,o.k.getPkgInfo).then(function(n){t.listLoading=!1,Object(l.a)(n,function(n){if("CONTENT"==n.status){if(n.content.value){var i=JSON.parse(n.content.value);"[object Array]"===Object.prototype.toString.call(i)&&i.length>0&&i.forEach(function(t){var n=void 0;"compressed"==t.pkgtype?n="tar":"debian"==t.pkgtype&&(n="deb");var i={type:"uninstall",filename:t.pkgname,productname:t.appname,version:t.version,address:t.address,filetype:n};e.push(i),a.push(i)})}t.getRepoPkgs(e,a)}})})}else console.error("selectAgentId is empty");else console.error("Cannot operate in a batch mode")},removeObjInArray:function(t,e){"[object Array]"===Object.prototype.toString.call(t)?t.forEach(function(a,n){a.productname===e&&t.splice(n,1)}):console.error("data is not array")},getRepoPkgs:function(t,e){var a=this;if("[object Array]"==Object.prototype.toString.call(t)&&"[object Array]"==Object.prototype.toString.call(e)){var n={},i={};this.listLoading=!0,Object(u.a)().then(function(s){a.listLoading=!1,Object(l.a)(s,function(s){"success"===s.status&&"[object Array]"===Object.prototype.toString.call(s.data)&&s.data.forEach(function(a){null!=a.versionName&&a.versionName;n={type:"install",filename:a.filename,productname:a.productname,version:a.version,address:a.address,filetype:a.type},t.push(n),e.forEach(function(n,s){n.productname==a.productname&&(t.pop(),e[s].address=a.address,_g.cpr_version(a.version,n.version)&&(i={type:"upgrade",filename:a.filename,productname:a.productname,version:a.version,address:a.address,filetype:a.type},t.push(i)))})}),a.pkgTableData=t.reverse()})})}else console.error("getRepoPkgs　parameter is not array")},filterType:function(t,e){return e.type===t},filterFileType:function(t,e){return e.filetype===t},actionAppSensor:function(t,e){var a=this;void 0!==o.k[t]?this.selectedAgentId?_g.swalWarnDo(this.$t("global.areYouSure"),this.$t("linuxPkgControl."+t),this.$t("global.confirm"),this.$t("global.cancel")).then(function(n){n&&(_g.openGlobalLoading(),Object(r.b)(a.selectedAgentId,o.k[t],e).then(function(t){Object(l.a)(t,function(t){"CHANGED"==t.status?(a.activeName="pkgStatusHistory",a.$refs.pkgHistory.intervalGetPkgStatusHistory()):_g.handleError(t)})}))}):this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")}):this.$swal("",this.$t("global.functionNotSupport"),"info",{button:this.$t("global.confirm")})},isFinished:function(){this.selectedAgentId&&(this.isOffline||this.getSensorStatus())},appAction:function(t,e){var a;a=e.address+"/"+e.filename;var n={taskname:this.singleDebType+(new Date).getTime(),productname:e.productname,version:e.version,downloadpath:a,type:this.singleDebType};this.actionAppSensor(t,n)},initData:function(){this.startApp="",this.stopApp="",this.enableApp="",this.disableApp="",this.pkgTableData=[]},handleClick:function(t){"pkgStatusHistory"===t.name?this.$emit("isDisabled",!1):this.$emit("isDisabled",!0)}},watch:{isSingleMode:function(t){t&&this.initData()},selectedAgentId:function(t){this.isSingleMode&&(this.initData(),t&&!this.isOffline&&this.getSensorStatus())}},computed:{isShowSearchInput:function(){return"linuxMarket"===this.activeName}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.isSingleMode,expression:"isSingleMode"}],staticClass:"p-r"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSearchInput,expression:"isShowSearchInput"}],staticClass:"search"},[n("el-input",{staticClass:"w-250 m-l-10",attrs:{size:"small",placeholder:t.$t("linuxPkgControl.keywordHolder")},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._v(" "),n("i",{staticClass:"fa fa-search search-icon",attrs:{"aria-hidden":"true"}})],1),t._v(" "),n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{name:"linuxMarket"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"fa fa-sellsy m-r-5",attrs:{"aria-hidden":"listLoading"}}),t._v("\n                 "+t._s(t.$t("linuxPkgControl.pkgMarket"))+"\n            ")]),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.pkgTableData.filter(function(e){return!t.keywords||e.productname.toLowerCase().includes(t.keywords.toLowerCase())}),"tooltip-effect":"dark","header-cell-style":{background:"#fafafa",color:"#606266"}}},[n("el-table-column",{attrs:{label:"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",["deb"==e.row.filetype?n("img",{staticStyle:{width:"52px"},attrs:{src:a("fMou"),alt:"no img"}}):t._e(),t._v(" "),"tar"==e.row.filetype?n("img",{staticStyle:{width:"48px"},attrs:{src:a("yySc"),alt:"no img"}}):t._e()])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"filename",label:t.$t("linuxPkgControl.fileName"),"min-width":"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"productname",label:t.$t("linuxPkgControl.productName"),"min-width":"120",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"version",label:t.$t("linuxPkgControl.version"),"min-width":"120",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"filetype",label:t.$t("linuxPkgControl.fileType"),"min-width":"120",filters:[{text:t.$t("linuxPkgControl.debPkg"),value:"deb"},{text:t.$t("linuxPkgControl.compressPkg"),value:"tar"}],"filter-method":t.filterFileType,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",["deb"==e.row.filetype?n("span",[t._v("\n                                "+t._s(t.$t("linuxPkgControl.debPkg"))+"\n                            ")]):t._e(),t._v(" "),"tar"==e.row.filetype?n("span",[t._v("\n                                "+t._s(t.$t("linuxPkgControl.compressPkg"))+"\n                            ")]):t._e()])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:t.$t("linuxPkgControl.action"),"min-width":"120",filters:[{text:t.$t("linuxPkgControl.uninstall"),value:"uninstall"},{text:t.$t("linuxPkgControl.install"),value:"install"},{text:t.$t("linuxPkgControl.upgrade"),value:"upgrade"}],"filter-method":t.filterType,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[n("el-button-group",["uninstall"===e.row.type?n("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.appAction("uninstall",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.uninstall"))+"\n                                    ")]):t._e(),t._v(" "),"upgrade"===e.row.type?n("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){t.appAction("upgrade",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.upgrade"))+"\n                                    ")]):t._e(),t._v(" "),"install"===e.row.type?n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.appAction("install",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.install"))+"\n                                    ")]):t._e()],1)],1)])]}}])})],1)],1),t._v(" "),n("el-tab-pane",{attrs:{name:"pkgStatusHistory"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"fa fa-history m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("linuxPkgControl.linuxManagerHistory"))+"\n            ")]),t._v(" "),n("pkg-history",{ref:"pkgHistory",attrs:{statusType:t.singleDebType,selectedAgentId:t.selectedAgentId},on:{isFinished:t.isFinished}})],1)],1)],1)},staticRenderFns:[]};var b=a("C7Lr")(m,v,!1,function(t){a("V3KR")},"data-v-0b266828",null).exports,y=(a("OT2R"),{name:"batchlinuxPkgControl",data:function(){var t=this;return{activeName:"linuxMarket",pkgTableData:[],defaultImg:'this.src="static/imgs/default_windows.png"',dialogTasknameVisible:!1,productname:"",version:"",address:"",filename:"",type:"",pkgStatusForm:{taskname:""},rules:{taskname:{required:!0,validator:function(e,a,n){if(!new RegExp(/^(?![._-\s])[\u4E00-\u9FA5A-Za-z0-9_\-\.\s]{1,12}$/).test(a))return n(new Error(t.$t("global.verifyShortError")));n()},trigger:"blur"}},batchDebType:p.g,cid:"",disableAppArray:p.o,isShowOverview:!1,linux_taskname:"",success:0,installing:0,failed:0,listLoading:!1,keywords:""}},props:{selectedAgentsData:{type:Array,default:[]},groupname:{type:String,default:""},isSingleMode:{type:Boolean,default:!0}},components:{pkgHistory:h},methods:{filterType:function(t,e){return e.type===t},getSensorStatus:function(){var t=this;if(this.isSingleMode)console.error("Cannot operate in a single mode");else if(0!=this.selectedAgentsData.length){var e=[],a=[];this.listLoading=!0,Object(r.e)(this.selectedAgentsData[0].value,o.k.getPkgInfo).then(function(n){t.listLoading=!1,Object(l.a)(n,function(n){if("CONTENT"==n.status){if(n.content.value){var i=JSON.parse(n.content.value);"[object Array]"===Object.prototype.toString.call(i)&&i.length>0&&i.forEach(function(t){var n=void 0;"compressed"==t.pkgtype?n="tar":"debian"==t.pkgtype&&(n="deb");var i={type:"uninstall",filename:t.pkgname,productname:t.appname,version:t.version,address:t.address,filetype:n};e.push(i),a.push(i)})}t.getRepoPkgs(e,a)}})})}else console.error("getSensorStatus: agentData is null")},removeObjInArray:function(t,e){"[object Array]"===Object.prototype.toString.call(t)?t.forEach(function(a,n){a.productname===e&&t.splice(n,1)}):console.error("data is not array")},getRepoPkgs:function(t,e){var a=this;if("[object Array]"==Object.prototype.toString.call(t)&&"[object Array]"==Object.prototype.toString.call(e)){var n={},i={};this.listLoading=!0,Object(u.a)().then(function(s){a.listLoading=!1,Object(l.a)(s,function(s){"success"===s.status&&"[object Array]"===Object.prototype.toString.call(s.data)&&s.data.forEach(function(a){null!=a.versionName&&a.versionName;n={type:"install",filename:a.filename,productname:a.productname,version:a.version,address:a.address,filetype:a.type},t.push(n),e.forEach(function(n,s){n.productname==a.productname&&(t.pop(),e[s].address=a.address,_g.cpr_version(a.version,n.version)&&(i={type:"upgrade",filename:a.filename,productname:a.productname,version:a.version,address:a.address,filetype:a.type},t.push(i)))})}),a.pkgTableData=t.reverse()})})}else console.error("getRepoPkgs　parameter is not array")},batchSetAppSensor:function(t,e){var a=this;if(void 0!==o.k[t]){_g.openGlobalLoading();var n={groupname:this.groupname,taskname:this.pkgStatusForm.taskname,productname:this.productname,type:this.type,version:this.version,downloadpath:e},i=this.pkgStatusForm.taskname;this.dialogTasknameVisible=!1,Object(r.a)(o.k[t],n).then(function(t){Object(l.a)(t,function(t){"CHANGED"==t.status?(Object(c.f)("linux_taskname",i),a.activeName="winStatusHistory",a.$refs.pkgHistory.intervalGetPkgStatusHistory()):_g.handleError(t)})})}else this.$swal("",this.$t("global.functionNotSupport"),"info",{button:this.$t("global.confirm")})},batchinstallPkg:function(){var t=this;0!==this.selectedAgentsData.length?this.$refs.pkgStatusForm.validate(function(e){if(e){var a=t.address+"/"+t.filename;t.batchSetAppSensor(t.cid,a)}}):this.$swal("",this.$t("global.devicesOffline"),"info",{button:this.$t("global.confirm")})},selectBatchinstallPkg:function(t,e){this.cid=t,this.address=e.address,this.productname=e.productname,this.filename=e.filename,this.version=e.version,this.type=this.batchDebType,this.pkgStatusForm.taskname="",this.dialogTasknameVisible=!0},initPkgInfo:function(){this.productname="",this.version="",this.address="",this.pkgStatusForm.taskname="",this.cid="",this.type="",this.filename=""},getBatchAppStatusCount:function(){var t=this,e=Object(c.c)("linux_taskname");if(!e)return console.error("getBatchAppStatusCount:localStorage(linux_taskname) is null"),void(this.isShowOverview=!1);Object(d.k)(e,p.g).then(function(a){Object(l.a)(a,function(a){a&&(t.linux_taskname=e,t.installing=a.installing,t.failed=a.fail,t.success=a.success,t.total>0&&"winStatusHistory"===t.activeName?t.isShowOverview=!0:t.isShowOverview=!1)})})},initData:function(){this.pkgTableData=[]},handleClick:function(t){"winStatusHistory"===t.name?this.getBatchAppStatusCount():this.isShowOverview=!1},isFinished:function(){this.getSensorStatus()},fileType:function(t,e){return e.filetype===t},filterFileType:function(t,e){return e.filetype===t}},computed:{isShowSearchInput:function(){return"linuxMarket"===this.activeName},total:function(){return this.success+this.installing+this.failed}},watch:{isSingleMode:function(t){t||this.initData()},groupname:function(t){!this.isSingleMode&&t&&(this.initData(),this.getSensorStatus())}}}),k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isSingleMode,expression:"!isSingleMode"}],staticClass:"pkgStatusContent p-r"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowSearchInput,expression:"isShowSearchInput"}],staticClass:"search"},[n("el-input",{staticClass:"w-250 m-l-10",attrs:{size:"small",placeholder:t.$t("linuxPkgControl.keywordHolder")},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}}),t._v(" "),n("i",{staticClass:"fa fa-search search-icon",attrs:{"aria-hidden":"true"}})],1),t._v(" "),n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{name:"linuxMarket"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"fa fa-sellsy m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("linuxPkgControl.pkgMarket"))+"\n            ")]),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.pkgTableData.filter(function(e){return!t.keywords||e.productname.toLowerCase().includes(t.keywords.toLowerCase())}),"tooltip-effect":"dark","header-cell-style":{background:"#fafafa",color:"#606266"}}},[n("el-table-column",{attrs:{label:"",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",["deb"==e.row.filetype?n("img",{staticStyle:{width:"52px"},attrs:{src:a("fMou"),alt:"no img"}}):t._e(),t._v(" "),"tar"==e.row.filetype?n("img",{staticStyle:{width:"48px"},attrs:{src:a("yySc"),alt:"no img"}}):t._e()])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"filename",label:t.$t("linuxPkgControl.fileName"),"min-width":"120"}}),t._v(" "),n("el-table-column",{attrs:{prop:"productname",label:t.$t("linuxPkgControl.productName"),"min-width":"120",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"version",label:t.$t("linuxPkgControl.version"),"min-width":"120",sortable:""}}),t._v(" "),n("el-table-column",{attrs:{prop:"filetype",label:t.$t("linuxPkgControl.fileType"),"min-width":"120",filters:[{text:t.$t("linuxPkgControl.debPkg"),value:"deb"},{text:t.$t("linuxPkgControl.compressPkg"),value:"tar"}],"filter-method":t.filterFileType,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",["deb"==e.row.filetype?n("span",[t._v("\n                                "+t._s(t.$t("linuxPkgControl.debPkg"))+"\n                            ")]):t._e(),t._v(" "),"tar"==e.row.filetype?n("span",[t._v("\n                                "+t._s(t.$t("linuxPkgControl.compressPkg"))+"\n                            ")]):t._e()])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:t.$t("linuxPkgControl.action"),"min-width":"120",filters:[{text:t.$t("linuxPkgControl.uninstall"),value:"uninstall"},{text:t.$t("linuxPkgControl.install"),value:"install"},{text:t.$t("linuxPkgControl.upgrade"),value:"upgrade"}],"filter-method":t.filterType,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",[n("span",[n("el-button-group",["uninstall"===e.row.type?n("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.selectBatchinstallPkg("uninstall",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.uninstall"))+"\n                                    ")]):t._e(),t._v(" "),"upgrade"===e.row.type?n("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){t.selectBatchinstallPkg("upgrade",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.upgrade"))+"\n                                    ")]):t._e(),t._v(" "),"install"===e.row.type?n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){t.selectBatchinstallPkg("install",e.row)}}},[t._v("\n                                        "+t._s(t.$t("linuxPkgControl.install"))+"\n                                    ")]):t._e()],1)],1)])]}}])})],1)],1),t._v(" "),n("el-tab-pane",{attrs:{name:"winStatusHistory"}},[n("span",{attrs:{slot:"label"},slot:"label"},[n("i",{staticClass:"fa fa-history m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("linuxPkgControl.linuxManagerHistory"))+"\n            ")]),t._v(" "),n("pkg-history",{ref:"pkgHistory",attrs:{statusType:t.batchDebType,groupname:t.groupname},on:{getStatusCount:t.getBatchAppStatusCount,isFinished:t.isFinished}})],1)],1),t._v(" "),n("el-dialog",{attrs:{visible:t.dialogTasknameVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTasknameVisible=e},close:function(e){t.initPkgInfo()}}},[n("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[n("i",{staticClass:"fa fa-level-up m-r-10"}),t._v("\n            "+t._s(t.$t("linuxPkgControl.batchInstallPkg"))+"\n        ")]),t._v(" "),n("el-form",{ref:"pkgStatusForm",attrs:{model:t.pkgStatusForm,rules:t.rules}},[n("el-form-item",{attrs:{label:t.$t("label.taskName"),"label-width":"230px",prop:"taskname"}},[n("el-input",{staticClass:"max-w-350",attrs:{autocomplete:"off",placeholder:t.$t("linuxPkgControl.installPkgTaskName")},model:{value:t.pkgStatusForm.taskname,callback:function(e){t.$set(t.pkgStatusForm,"taskname","string"==typeof e?e.trim():e)},expression:"pkgStatusForm.taskname"}})],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogTasknameVisible=!1}}},[t._v(t._s(t.$t("global.cancel")))]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.batchinstallPkg()}}},[t._v(t._s(t.$t("global.confirm")))])],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowOverview,expression:"isShowOverview"}],staticClass:"appStatusCount"},[n("span",[t._v(t._s(t.$t("label.taskName"))+" "+t._s(t.linux_taskname))]),t._v(" "),n("span",[t._v(t._s(t.$t("linuxPkgControl.total"))+" "+t._s(t.total))]),t._v(" "),n("span",[t._v(t._s(t.$t("linuxPkgControl.deploying"))+" "+t._s(t.installing))]),t._v(" "),n("span",[t._v(t._s(t.$t("linuxPkgControl.success"))+" "+t._s(t.success))]),t._v(" "),n("span",[t._v(t._s(t.$t("linuxPkgControl.failed"))+" "+t._s(t.failed))])])],1)},staticRenderFns:[]};var _=a("C7Lr")(y,k,!1,function(t){a("bEks")},"data-v-2fa08720",null).exports,S={name:"controlAppcontrol",data:function(){return{selectedAgentId:"",selectedAgentsData:[],isSingleMode:!0,groupname:"",isDisabledOffDev:!0,isOffline:!1,groupType:p.u.linux,groupTypeArray:[p.u.linux]}},components:{selectDevice:n.a,selectGroup:s.a,modeSwitch:i.a,singleControl:b,batchControl:_},methods:{getDeviceOption:function(t){this.selectedAgentId=t},getGroupOption:function(t){this.selectedAgentsData=t},initData:function(){this.selectedAgentId="",this.groupname="",this.selectedAgentsData=[]},changeMode:function(t){this.initData(),this.isSingleMode=!t},getGroupName:function(t){this.groupname=t},isDisabled:function(t){this.isDisabledOffDev=t},isOfflineDev:function(t){this.isOffline=t}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-box"},[a("div",{staticClass:"title-box"},[a("p",{staticClass:"header-line"},[a("i",{staticClass:"fa fa-sliders m-r-10"}),t._v("\n            "+t._s(t.$t("linuxPkgControl.pkgDeploy"))+"\n            \n        ")])]),t._v(" "),a("div",{staticClass:"select-box"},[a("mode-switch",{on:{"mode-status":t.changeMode}}),t._v(" "),a("span",{staticClass:"vertical"}),t._v(" "),a("select-group",{attrs:{isSingleMode:t.isSingleMode,groupType:t.groupTypeArray},on:{"select-getDeviceOptions":t.getGroupOption,"select-getGroupName":t.getGroupName}}),t._v(" "),a("select-device",{attrs:{isSingleMode:t.isSingleMode,isDisabledOffDev:t.isDisabledOffDev,groupType:t.groupType},on:{"select-device":t.getDeviceOption,isOfflineDev:t.isOfflineDev}})],1),t._v(" "),a("div",{staticClass:"table-box"},[a("single-control",{attrs:{selectedAgentId:t.selectedAgentId,isSingleMode:t.isSingleMode,isOffline:t.isOffline},on:{isDisabled:t.isDisabled}}),t._v(" "),a("batch-control",{attrs:{selectedAgentsData:t.selectedAgentsData,isSingleMode:t.isSingleMode,groupname:t.groupname}})],1)])},staticRenderFns:[]};var C=a("C7Lr")(S,w,!1,function(t){a("uux8")},"data-v-748c7278",null);e.default=C.exports},uZZm:function(t,e,a){"use strict";a.d(e,"a",function(){return l});var n=a("rVsN"),i=a.n(n),s=a("5Y2G"),o=a("OT2R"),l=function(){return new i.a(function(t,e){Object(o.c)().then(function(e){var a=e+"/repoLinuxPkg";Object(s.h)(a,"").then(function(e){t(e)}).catch(function(e){t(e.response)})})})}},uux8:function(t,e){},xKvL:function(t,e){}});
//# sourceMappingURL=13.f88893fc6067ac449d86.js.map