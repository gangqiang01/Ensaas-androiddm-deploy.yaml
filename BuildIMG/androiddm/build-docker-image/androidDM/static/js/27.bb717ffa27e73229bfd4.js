webpackJsonp([27],{H4MM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("3cXf"),c=n.n(s),i=n("jnx8"),o=n("42+z"),a=n("yjGV"),r=n("cEza"),d=n("OT2R"),l=n("YMj5"),u=n("jwu5"),h=n("/eZD"),v={name:"vncList",data:function(){return{selectedAgentId:"",selectedDeviceId:"",rfb:null,vncMode:3,repeaterID:0,desktopName:"",connectStatus:"disconnect",isShowClosed:!1,level:"",VNCStatus:"",groupType:h.u.android}},components:{selectDevice:o.a},methods:{disconnectVNC:function(){Object(l.h)(this.selectedAgentId,u.l.stopVncServer,!0),null!=this.rfb&&(console.log("close vnc ..."),this.rfb._disconnect())},setRepeaterId:function(){this.repeaterID=Math.floor(9e3*Math.random())+1e3},separateUrl:function(e){e.substring(e.indexOf(""))},connectVncServer:function(){var e=this;if(this.selectedAgentId){var t=Math.floor(9e3*Math.random())+1e3+"";this.status("connecting","normal","connecting"),window.setTimeout(function(){Object(d.h)().then(function(n){var s={repeaterid:e.repeaterID,url:h.y,password:t};Object(l.h)(e.selectedAgentId,u.l.startVncServer,c()(s)).then(function(s){Object(i.a)(s,function(s){if(s.status="CHANGED"){window.setTimeout(function(){e.startVNC(n,"",t,"websockify/?token=00190F2A51F5")},3e3)}else _g.handleError(s)})})})},2e3)}else this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")})},updateDesktopName:function(e){this.desktopName=e.detail.name},status:function(e,t,n){switch(t){case"normal":case"warn":break;case"error":n="disconnect";break;default:this.level="warn"}"connecting"==n?(this.isShowClosed=!1,this.connectStatus="connecting"):"disconnect"==n?(this.isShowClosed=!1,this.connectStatus="disconnect"):(this.isShowClosed="true",this.connectStatus="connected"),this.level=t,this.VNCStatus=e},connected:function(e){a.b("encrypt",!0)?this.status("Connected (encrypted) to "+this.desktopName,"normal","connected"):this.status("Connected (unencrypted) to "+this.desktopName,"normal","connected")},disconnected:function(e){e.detail.clean?this.status("disconnect","normal","disconnect"):this.status("Something went wrong, Try connecting again later","error","error")},startVNC:function(e,t,n,s){var c=a.b("token",null);if(c&&(s=a.c(s,"token",c),a.a("token",c,1)),this.status("connecting","normal","connecting"),e){var i="wss";i+="://"+e,t&&(i+=":"+t),i+="/"+s,this.rfb=new r.a(document.getElementById("noVNC_content"),i,{repeaterID:this.repeaterID,shared:!0,credentials:{password:n}}),this.rfb.viewOnly=a.b("view_only",!1),this.rfb.addEventListener("connect",this.connected),this.rfb.addEventListener("disconnect",this.disconnected),this.rfb.addEventListener("desktopname",this.updateDesktopName),this.rfb.scaleViewport=!0,this.rfb.resizeSession=a.b("resize",!1)}else this.status("Must be a specify connect URL","error","error")},getDeviceOption:function(e){this.selectedAgentId&&this.disconnectVNC(),this.setRepeaterId(),this.selectedAgentId=e}},created:function(){this.setRepeaterId()},beforeDestroy:function(){""!=this.selectedAgentId&&(this.disconnectVNC(),this.selectedAgentId="")}},f={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"content"},[s("div",{staticClass:"title-box"},[s("p",{staticClass:"header-line"},[s("i",{staticClass:"fa fa-desktop m-r-10"}),e._v(e._s(e.$t("vnc.remoteDesktop")))])]),e._v(" "),s("div",{staticClass:"select-box"},[s("select-device",{on:{"select-device":e.getDeviceOption}})],1),e._v(" "),s("div",{staticClass:"table"},[s("div",{attrs:{id:"noVNC_content"}},[s("i",{directives:[{name:"show",rawName:"v-show",value:e.isShowClosed,expression:"isShowClosed"}],staticClass:"fa fa-times fa-x pointer",attrs:{id:"VNC_closed"},on:{click:e.disconnectVNC}}),e._v(" "),s("div",{class:["noVNC_status_"+e.level],attrs:{id:"noVNC_status_bar"}},[s("div",{attrs:{id:"noVNC_left_dummy_elem"}}),e._v(" "),s("div",{attrs:{id:"noVNC_status"}},[e._v("\n                     "+e._s(e.VNCStatus)+"\n                 ")]),e._v(" "),s("div",{attrs:{id:"VNC_enter"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"disconnect"===e.connectStatus,expression:"connectStatus === 'disconnect'"}]},[s("h2",{staticClass:"VNC_title"},[e._v(e._s(e.$t("vnc.remoteToYourDevice")))]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.connectVncServer()}}},[s("i",{staticClass:"fa fa-link"}),e._v(" "+e._s(e.$t("vnc.connect"))+"\n                         ")])],1),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"connecting"===e.connectStatus,expression:"connectStatus === 'connecting'"}]},[s("img",{attrs:{src:n("2OfZ"),alt:"no img"}})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"connected"===e.connectStatus,expression:"connectStatus === 'connected'"}]})])])])])])},staticRenderFns:[]};var p=n("C7Lr")(v,f,!1,function(e){n("TJ+K")},"data-v-83e43742",null);t.default=p.exports},"TJ+K":function(e,t){}});
//# sourceMappingURL=27.bb717ffa27e73229bfd4.js.map