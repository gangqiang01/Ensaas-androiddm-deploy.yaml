webpackJsonp([15],{BUXM:function(t,e){},SvjY:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("42+z"),i=(s("jwu5"),s("YMj5"),s("37tL")),o=s("/eZD"),n=s("22O3"),l=s("jnx8"),r={name:"batchSetupHistory",data:function(){var t=this;return{setupStatusForm:{taskname:""},rules:{taskname:{validator:function(e,s,a){if(!new RegExp(/^(?![._-])[a-zA-Z0-9\.\-_]{3,12}$/).test(s))return a(new Error(t.$t("global.verifyShortError")));a()},trigger:"blur"}},pluginsStatusHistoryTableList:[],isshow:!1,limit:10,dataCount:0,currentPage:1,multipleSelection:[],isShowBtnGroup:!1,clearLoading:!1,batchDeletePluginsStatusHistory:i.a,intervalTime:7e3,isInterval:!1,listLoading:!1,singleInstallType:o.I,batchInstallType:o.k,statusArray:[]}},components:{btnGroup:s("C+p8").a},props:{statusType:{default:o.k,type:String},selectedAgentId:{default:"",type:String},groupname:{default:"",type:String}},methods:{isSuccess:function(t){t&&this.intervalGetPluginsStatusHistory()},reSetup:function(t){var e=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("appControl.reinstall"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(s){if(s){var a=void 0;a=-1!=t.function.indexOf("Schedule")?{pluginname:o.v,actions:t.actions,cycle:t.cycle,time:t.datetime,taskname:t.taskname}:{pluginname:o.v,actions:t.actions,taskname:t.taskname},Object(i.l)(t.endpoint,a).then(function(t){Object(l.a)(t,function(t){t.status,e.intervalGetPluginsStatusHistory()})})}})},deleteHistory:function(t){var e=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("global.delete"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(s){s&&(e.listLoading=!0,Object(i.g)(t).then(function(t){e.listLoading=!1,Object(l.a)(t,function(t){"CHANGED"===t.status?e.$swal("",e.$t("global.success"),"success",{button:e.$t("global.confirm")}).then(function(){e.intervalGetPluginsStatusHistory()}):(_g.handleError(t),e.intervalGetPluginsStatusHistory())})}))})},clearAll:function(){var t=this;_g.swalInfoDo(this.$t("global.areYouSure"),this.$t("global.clearAll"),this.$t("global.confirm"),this.$t("global.cancel")).then(function(e){e&&(t.clearLoading=!0,t.statusType==o.k?Object(i.f)(t.groupname,o.O).then(function(e){t.clearLoading=!1,Object(l.a)(e,function(e){"CHANGED"===e.status?t.$swal("",t.$t("global.success"),"success",{button:t.$t("global.confirm")}).then(function(){t.intervalGetPluginsStatusHistory()}):_g.handleError(e)})}):deletePluginsStatusHistoryAllByDevIdApi(t.selectedAgentId).then(function(e){t.clearLoading=!1,Object(l.a)(e,function(e){"CHANGED"===e.status?t.$swal("",t.$t("global.success"),"success",{button:t.$t("global.confirm")}).then(function(){t.intervalGetPluginsStatusHistory()}):_g.handleError(e)})}))})},checkSelectable:function(t){return 0==!t.status},selectItem:function(t){this.multipleSelection=t},handleCurrentChange:function(t){this.currentPage=t||1,this.intervalGetPluginsStatusHistory()},filterStatus:function(t){this.statusArray=t.status,this.currentPage=1,_g.isArray(this.statusArray)&&this.intervalGetPluginsStatusHistory()},assignPluginsStatusData:function(t){if("[object Object]"===Object.prototype.toString.call(t)&&"[object Array]"===Object.prototype.toString.call(t.data)){this.dataCount=t.count,this.pluginsStatusHistoryTableList=t.data,this.isshow=this.dataCount>this.limit,this.isShowBtnGroup=this.dataCount>0;var e=!0;this.statusType==o.k&&this.$emit("getStatusCount"),t.data.forEach(function(t){0==t.status&&(e=!1)}),e&&(this.$emit("isFinished"),window.clearInterval(_g.timer),_g.timer=null)}else window.clearInterval(_g.timer),_g.timer=null},getPluginsStatusHistoryByGroupname:function(){var t=this;this.groupname||console.error("[getPluginsStatusHistoryByGroupname]groupname is empty"),!1===this.isInterval&&(this.listLoading=!0),this.statusArray.length>0?Object(i.i)(this.groupname,this.currentPage,this.limit,this.statusArray,o.O).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignPluginsStatusData(e)})}):Object(i.j)(this.groupname,this.currentPage,this.limit,o.O).then(function(e){t.listLoading=!1,Object(l.a)(e,function(e){t.assignPluginsStatusData(e)})})},intervalGetPluginsStatusHistory:function(){var t=this;this.statusType==o.k?(this.getPluginsStatusHistoryByGroupname(),null===_g.timer&&(_g.timer=window.setInterval(function(){t.getPluginsStatusHistoryByGroupname(),t.isInterval=!0},this.intervalTime))):(this.getPluginsStatusHistoryBydevid(),null===_g.timer&&(_g.timer=window.setInterval(function(){t.getPluginsStatusHistoryBydevid(),t.isInterval=!0},this.intervalTime)))},initData:function(){this.isshow=!1,this.isShowBtnGroup=!1,this.pluginsStatusHistoryTableList=[],this.currentPage=1}},created:function(){this.statusType==o.k&&this.$emit("getStatusCount")},beforeDestroy:function(){},watch:{groupname:function(t){this.initData(),t&&this.intervalGetPluginsStatusHistory()},selectedAgentId:function(t){this.initData(),t&&this.intervalGetPluginsStatusHistory()}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],ref:"pluginsStatusHistoryTable",staticStyle:{width:"100%"},attrs:{data:t.pluginsStatusHistoryTableList,"tooltip-effect":"dark","default-sort":{prop:"ts",order:"descending"}},on:{"selection-change":t.selectItem,"filter-change":t.filterStatus}},[a("el-table-column",{attrs:{type:"selection","min-width":"50",selectable:t.checkSelectable}}),t._v(" "),a("el-table-column",{attrs:{prop:"devname",label:t.$t("remoteControl.deviceName"),"min-width":"120"}}),t._v(" "),t.statusType==t.batchInstallType?a("el-table-column",{attrs:{prop:"taskname",label:t.$t("remoteControl.taskName"),"min-width":"120"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{label:t.$t("remoteControl.beginTime"),"min-width":"130",prop:"ts"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("time")(e.row.ts))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"function",label:t.$t("remoteControl.function"),"min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"cycle",label:t.$t("remoteControl.cycleTime"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("none")(e.row.cycle))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("remoteControl.dateTime"),"min-width":"130",prop:"datetime"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("time")(e.row.datetime))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{"column-key":"status",prop:"status",label:t.$t("remoteControl.status"),"min-width":"130",filters:[{text:t.$t("global.success"),value:2},{text:t.$t("global.failed"),value:1},{text:t.$t("global.running"),value:0}],"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("img",{staticStyle:{width:"50px",height:"10px"},attrs:{src:s("PLes"),alt:""}}):t._e(),t._v(" "),2==e.row.status?a("span",{staticClass:"badge bg-green"},[t._v(t._s(t.$t("global.success")))]):t._e(),t._v(" "),1==e.row.status?a("span",{staticClass:"badge bg-DimGray"},[t._v(t._s(t.$t("global.failed")))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("remoteControl.errorStatus"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                "+t._s(t._f("appErrorStatus")(""+e.row.errorcode))+"\n            ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("appControl.action"),"min-width":"175",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("el-button-group",[a("el-button",{attrs:{size:"mini",type:"danger",disabled:0==e.row.status},on:{click:function(s){t.deleteHistory(e.row.psid)}}},[t._v("\n                                "+t._s(t.$t("global.delete"))+"\n                        ")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary",disabled:1!=e.row.status},on:{click:function(s){t.reSetup(e.row)}}},[t._v("\n                                "+t._s(t.$t("appControl.reinstall"))+"\n                        ")])],1)],1)]}}])})],1),t._v(" "),a("btn-group",{directives:[{name:"show",rawName:"v-show",value:t.isShowBtnGroup,expression:"isShowBtnGroup"}],staticClass:"fl m-t-10 cf",attrs:{selectedData:t.multipleSelection,isDelete:!0,isMove:!1,tid:"psid",delApi:t.batchDeletePluginsStatusHistory},on:{result:t.isSuccess}}),t._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.clearLoading,expression:"clearLoading"},{name:"show",rawName:"v-show",value:t.isShowBtnGroup,expression:"isShowBtnGroup"}],staticClass:"fl m-t-10 cf m-l-10",attrs:{size:"small",type:"primary"},on:{click:function(e){t.clearAll()}}},[t._v("\n    "+t._s(t.$t("appControl.clearAll"))+"\n    ")]),t._v(" "),a("div",{staticClass:"m-t-10 cf fr"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.isshow,expression:"isshow"}],attrs:{layout:"prev, pager, next","page-size":t.limit,"current-page":t.currentPage,total:t.dataCount,background:""},on:{"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var u=s("C7Lr")(r,c,!1,function(t){s("l8Mf")},"data-v-73f958a4",null).exports,h=s("HvBW"),d=(s("eq/O"),s("OT2R"),{name:"singleRemoteControl",data:function(){return{activeName:"systemSetup",radio:"1",rebootDate:"",shutdownDate:"",cycle:"",audio:0,brightness:0}},props:{selectedAgentId:{type:String,default:""},isSingleMode:{type:Boolean,default:!0},isOffline:{type:Boolean,default:!1}},methods:{handleBrightness:function(t){return t+"%"},handleAudio:function(t){return t+"%"},actionReboot:function(t,e){var s=this;this.selectedAgentId?this.rebootDate?2!=this.radio||this.cycle?_g.swalWarnDo(this.$t("global.areYouSure"),this.$t("remoteControl."+e),this.$t("global.confirm"),this.$t("global.cancel")).then(function(e){if(e){_g.openGlobalLoading();var a=new Date(s.rebootDate),n={pluginname:o.v,actions:t,time:a.getTime(),cycle:s.cycle};Object(i.m)(s.selectedAgentId,n).then(function(e){Object(l.a)(e,function(e){"CHANGED"===e.status?(s.$swal("",s.$t("global.success"),"success",{button:s.$t("global.confirm")}),!1===t.reboot&&s.getRebootPlan()):_g.handleError(e)})})}}):this.$swal("",this.$t("global.selectCycle"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]}):this.$swal("",this.$t("global.selectDate"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]}):this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},actionShutdown:function(t,e){var s=this;this.selectedAgentId?this.shutdownDate?_g.swalWarnDo(this.$t("global.areYouSure"),this.$t("remoteControl."+e),this.$t("global.confirm"),this.$t("global.cancel")).then(function(e){if(e){_g.openGlobalLoading();var a=new Date(s.shutdownDate),n={pluginname:o.v,actions:t,time:a.getTime()};Object(i.m)(s.selectedAgentId,n).then(function(e){Object(l.a)(e,function(e){"CHANGED"===e.status?(s.$swal("",s.$t("global.success"),"success",{button:s.$t("global.confirm")}),!1===t.shutdown&&s.getShutdownPlan()):_g.handleError(e)})})}}):this.$swal("",this.$t("global.selectDate"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]}):this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},switchChange:function(t,e){var s=this;if(""!=this.selectedAgentId){_g.openGlobalLoading();var a={pluginname:o.v,actions:t};Object(i.m)(this.selectedAgentId,a).then(function(t){Object(l.a)(t,function(t){"CHANGED"===t.status?s.$swal("",s.$t("global.success"),"success",{button:s.$t("global.confirm")}):_g.handleError(t,function(){s[e]=s.$options.data()[e]})})})}else this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},systemSetupAction:function(t,e){var s=this;""!=this.selectedAgentId?_g.swalWarnDo(this.$t("global.areYouSure"),this.$t("remoteControl."+e),this.$t("global.confirm"),this.$t("global.cancel")).then(function(e){if(e){_g.openGlobalLoading();var a={pluginname:o.v,actions:t};Object(i.m)(s.selectedAgentId,a).then(function(t){Object(l.a)(t,function(t){"CHANGED"===t.status?s.$swal("",s.$t("global.success"),"success",{button:s.$t("global.confirm")}):_g.handleError(t)})})}}):this.$swal("",this.$t("global.selectDevice"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},getShutdownPlan:function(){var t=this;Object(i.h)(this.selectedAgentId,"{'get_shutdown_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).shutdownTime);t.shutdownDate=s||""}})})},getRebootPlan:function(){var t=this;Object(i.h)(this.selectedAgentId,"{'get_reboot_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).rebootTime),a=parseInt(JSON.parse(e.content.value).rebootCycle);1==t.radio?t.rebootDate=s&&!a?s:"":s&&a?(t.cycle=a,t.rebootDate=s):(t.cycle="",t.rebootDate="")}})})},getRebootType:function(){var t=this;Object(i.h)(this.selectedAgentId,"{'get_reboot_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).rebootCycle);s?(t.cycle=s,t.radio="2"):(t.cycle="",t.radio="1")}})})},getDeviceBrightness:function(){var t=this;Object(i.h)(this.selectedAgentId,"{'get_brightness': 0}").then(function(e){Object(l.a)(e,function(e){"CONTENT"===e.status&&(t.brightness=parseInt(JSON.parse(e.content.value).brightness))})})},getDeviceAudio:function(){var t=this;Object(i.h)(this.selectedAgentId,"{'get_audio': true}").then(function(e){Object(l.a)(e,function(e){"CONTENT"===e.status&&(t.audio=parseInt(JSON.parse(e.content.value).get_audio))})})},handleClick:function(t){"systemSetup"===t.name?this.$emit("isDisabled",!1):this.$emit("isDisabled",!0)},initRebootData:function(){this.rebootDate="",this.cycle=""},initShutdownData:function(){this.shutdownDate=""},initData:function(){this.audio=0,this.brightness=0}},watch:{isSingleMode:function(t){t&&(this.activeName="systemSetup",this.initShutdownData(),this.initRebootData(),this.initData(),this.selectedAgentId&&(this.getShutdownPlan(),this.getRebootPlan(),this.getRebootType(),this.getDeviceBrightness(),this.getDeviceAudio()))},selectedAgentId:function(){this.initShutdownData(),this.initRebootData(),this.initData(),this.selectedAgentId&&(this.getShutdownPlan(),this.getRebootPlan(),this.getRebootType(),this.getDeviceBrightness(),this.getDeviceAudio())},radio:function(){this.initRebootData(),this.selectedAgentId&&this.getRebootPlan()}},computed:{options:function(){return[{value:1,label:this.$t("remoteControl.oneDay")},{value:7,label:this.$t("remoteControl.oneWeek")},{value:30,label:this.$t("remoteControl.oneMonth")},{value:90,label:this.$t("remoteControl.threeMonths")},{value:180,label:this.$t("remoteControl.sixMonths")},{value:365,label:this.$t("remoteControl.oneYear")}]}}}),b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:t.isSingleMode,expression:"isSingleMode"}]},[s("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"systemSetup"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"fa fa-wrench m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("remoteControl.systemSetup"))+"\n            ")]),t._v(" "),s("el-col",{staticClass:"m-t-20",attrs:{span:20}},[s("el-row",[s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkRed"},[s("i",{staticClass:"fa fa-undo info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.reboot")))])]),t._v(" "),s("el-button",{staticClass:"fa fa-undo",attrs:{circle:"",type:"danger",size:"small","aria-hidden":"true"},on:{click:function(e){t.systemSetupAction({reboot:!0},"reboot")}}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkViolet"},[s("i",{staticClass:"fa fa-power-off info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.shutdown")))])]),t._v(" "),s("el-button",{staticClass:"fa fa-power-off",attrs:{circle:"",type:"danger",size:"small","aria-hidden":"true"},on:{click:function(e){t.systemSetupAction({shutdown:!0},"shutdown")}}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-green"},[s("i",{staticClass:"fa fa-volume-up info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.audio")))])]),t._v(" "),s("el-slider",{staticClass:"counter",attrs:{step:1,min:0,max:100,"format-tooltip":t.handleAudio},on:{change:function(e){t.switchChange({set_audio:t.audio},"audio")}},model:{value:t.audio,callback:function(e){t.audio=e},expression:"audio"}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-Indigo"},[s("i",{staticClass:"fa fa-sun-o info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.brightness")))])]),t._v(" "),s("el-slider",{staticClass:"counter",attrs:{step:1,min:0,max:100,"format-tooltip":t.handleBrightness},on:{change:function(e){t.switchChange({set_brightness:t.brightness},"brightness")}},model:{value:t.brightness,callback:function(e){t.brightness=e},expression:"brightness"}})],1)])],1)],1)],1),t._v(" "),s("el-tab-pane",{attrs:{name:"schedule"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"fa fa-calendar m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("remoteControl.schedule"))+"\n            ")]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkRed"},[s("i",{staticClass:"fa fa-undo info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.reboot")))])]),t._v(" "),s("div",{staticClass:"date"},[s("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v(t._s(t.$t("remoteControl.once")))]),t._v(" "),s("el-radio",{attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v(t._s(t.$t("remoteControl.repeat")))]),s("br"),t._v(" "),s("el-date-picker",{staticClass:"m-t-15",attrs:{type:"datetime",placeholder:t.$t("remoteControl.datetimeHolder")},model:{value:t.rebootDate,callback:function(e){t.rebootDate=e},expression:"rebootDate"}}),t._v(" "),2==t.radio?s("el-select",{staticClass:"m-t-15",attrs:{placeholder:t.$t("remoteControl.cycleHolder")},model:{value:t.cycle,callback:function(e){t.cycle=e},expression:"cycle"}},t._l(t.options,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})):t._e(),s("br"),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.actionReboot({reboot:!1},"disable")}}},[t._v(t._s(t.$t("remoteControl.disable")))]),t._v(" "),s("el-button",{staticClass:"m-t-15 m-l-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.actionReboot({reboot:!0},"reboot")}}},[t._v(t._s(t.$t("remoteControl.save")))])],1)])]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkViolet"},[s("i",{staticClass:"fa fa-power-off info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.shutdown")))])]),t._v(" "),s("div",{staticClass:"date"},[s("el-date-picker",{staticClass:"m-t-30",attrs:{type:"datetime",placeholder:t.$t("remoteControl.datetimeHolder")},model:{value:t.shutdownDate,callback:function(e){t.shutdownDate=e},expression:"shutdownDate"}}),s("br"),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.actionShutdown({shutdown:!1},"disable")}}},[t._v(t._s(t.$t("remoteControl.disable")))]),t._v(" "),s("el-button",{staticClass:"m-t-15 m-l-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.actionShutdown({shutdown:!0},"shutdown")}}},[t._v(t._s(t.$t("remoteControl.save")))])],1)])])],1)],1)],1)},staticRenderFns:[]};var f=s("C7Lr")(d,b,!1,function(t){s("BUXM")},"data-v-60c0f046",null).exports,m={name:"batchRemoteControl",data:function(){var t=this;return{activeName:"systemSetup",audio:0,brightness:0,radio:"1",rebootDate:"",shutdownDate:"",cycle:"",dialogTasknameVisible:!1,batchSetupForm:{taskname:"",actions:"",datetime:"",cycle:""},rules:{taskname:{required:!0,validator:function(e,s,a){if(!new RegExp(/^(?![._-\s])[\u4E00-\u9FA5A-Za-z0-9_\-\.\s]{1,12}$/).test(s))return a(new Error(t.$t("global.verifyShortError")));a()},trigger:"blur"}},batchInstallType:o.k,listLoading:!1,isShowOverview:!1,rm_taskname:"",success:1,installing:1,failed:1}},props:{selectedAgentsData:{type:Array,default:[]},groupname:{type:String,default:""},isSingleMode:{type:Boolean,default:!0}},components:{pluginsHistory:u},methods:{handleBrightness:function(t){return t+"%"},handleAudio:function(t){return t+"%"},getBatchPluginsStatusCount:function(){var t=this,e=Object(n.c)("rm_taskname");if(!e)return console.error("getBatchPluginsStatusCount:localStorage(rm_taskname) is null"),void(this.isShowOverview=!1);Object(i.k)(e,"ssb").then(function(s){Object(l.a)(s,function(s){s&&(t.rm_taskname=e,t.installing=s.installing,t.failed=s.fail,t.success=s.success,t.total>0&&"batchSetupHistory"===t.activeName?t.isShowOverview=!0:t.isShowOverview=!1)})})},getSensorStatus:function(){this.isSingleMode?console.error("Cannot operate in a single mode"):0!=this.selectedAgentsData.length||console.error("getSensorStatus: agentData is null")},isFinished:function(){this.getSensorStatus()},initTasknameInfo:function(){this.batchSetupForm.taskname="",this.batchSetupForm.actions="",this.batchSetupForm.datetime="",this.batchSetupForm.cycle="",this.getDeviceBrightness(),this.getDeviceAudio()},batchSetup:function(t,e){var s=this;0!==this.selectedAgentsData.length?(this.batchSetupForm.actions=t,this.dialogTasknameVisible=!0):this.$swal("",this.$t("global.devicesOffline"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},batchScheduleReboot:function(t,e){var s=this;0!==this.selectedAgentsData.length?this.rebootDate?(this.batchSetupForm.datetime=this.rebootDate,2!=this.radio||this.cycle?(this.batchSetupForm.actions=t,this.batchSetupForm.cycle=this.cycle,this.dialogTasknameVisible=!0):this.$swal("",this.$t("global.selectCycle"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})):this.$swal("",this.$t("global.selectDate"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]}):this.$swal("",this.$t("global.devicesOffline"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},batchScheduleShutdown:function(t,e){var s=this;0!==this.selectedAgentsData.length?this.shutdownDate?(this.batchSetupForm.datetime=this.shutdownDate,this.batchSetupForm.actions=t,this.dialogTasknameVisible=!0):this.$swal("",this.$t("global.selectDate"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]}):this.$swal("",this.$t("global.devicesOffline"),"info",{button:this.$t("global.confirm")}).then(function(){s[e]=s.$options.data()[e]})},systemSetupAction:function(){var t=this;this.$refs.batchSetupForm.validate(function(e){if(e){var s=t.batchSetupForm.taskname;if("systemSetup"===t.activeName){var a={pluginname:o.v,actions:t.batchSetupForm.actions,taskname:t.batchSetupForm.taskname};t.dialogTasknameVisible=!1,Object(i.c)(t.groupname,a).then(function(e){Object(l.a)(e,function(e){"CHANGED"===e.status?(Object(n.f)("rm_taskname",s),t.activeName="batchSetupHistory",t.$refs.batchSetupHistory.intervalGetPluginsStatusHistory()):(_g.handleError(e),t.dialogTasknameVisible=!1)})})}else{var r=new Date(t.batchSetupForm.datetime),c={pluginname:o.v,actions:t.batchSetupForm.actions,time:r.getTime(),cycle:t.batchSetupForm.cycle,taskname:t.batchSetupForm.taskname};t.dialogTasknameVisible=!1,Object(i.b)(t.groupname,c).then(function(e){Object(l.a)(e,function(e){"CHANGED"===e.status?(Object(n.f)("rm_taskname",s),t.activeName="batchSetupHistory",t.$refs.batchSetupHistory.intervalGetPluginsStatusHistory(),!1===c.actions.reboot?t.getRebootPlan():!1===c.actions.shutdown&&t.getShutdownPlan()):(_g.handleError(e),t.dialogTasknameVisible=!1)})})}}})},getShutdownPlan:function(){var t=this;Object(i.h)(this.selectedAgentsData[0].value,"{'get_shutdown_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).shutdownTime);t.shutdownDate=s||""}})})},getRebootPlan:function(){var t=this;Object(i.h)(this.selectedAgentsData[0].value,"{'get_reboot_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).rebootTime),a=parseInt(JSON.parse(e.content.value).rebootCycle);1==t.radio?t.rebootDate=s&&!a?s:"":s&&a?(t.cycle=a,t.rebootDate=s):(t.cycle="",t.rebootDate="")}})})},getDeviceBrightness:function(){var t=this;Object(i.h)(this.selectedAgentsData[0].value,"{'get_brightness': 0}").then(function(e){Object(l.a)(e,function(e){"CONTENT"===e.status?t.brightness=parseInt(JSON.parse(e.content.value).brightness):_g.handleError(e)})})},getDeviceAudio:function(){var t=this;Object(i.h)(this.selectedAgentsData[0].value,"{'get_audio': true}").then(function(e){Object(l.a)(e,function(e){"CONTENT"===e.status?t.audio=parseInt(JSON.parse(e.content.value).get_audio):_g.handleError(e)})})},getRebootType:function(){var t=this;Object(i.h)(this.selectedAgentsData[0].value,"{'get_reboot_plan':true}").then(function(e){Object(l.a)(e,function(e){if("CONTENT"===e.status){var s=parseInt(JSON.parse(e.content.value).rebootCycle);s?(t.cycle=s,t.radio="2"):(t.cycle="",t.radio="1")}})})},handleClick:function(t){"batchSetupHistory"===t.name?this.getBatchPluginsStatusCount():this.isShowOverview=!1},initData:function(){this.rebootDate="",this.cycle=""},initShutdownData:function(){this.shutdownDate="",this.audio=0,this.brightness=0}},watch:{isSingleMode:function(t){t||(this.activeName="systemSetup",this.initData(),this.initShutdownData(),0!=this.selectedAgentsData.length&&(this.getShutdownPlan(),this.getRebootPlan(),this.getRebootType(),this.getDeviceBrightness(),this.getDeviceAudio()))},selectedAgentsData:function(){this.initData(),this.initShutdownData(),0!=this.selectedAgentsData.length&&(this.getShutdownPlan(),this.getRebootPlan(),this.getRebootType(),this.getDeviceBrightness(),this.getDeviceAudio())},groupname:function(t){!this.isSingleMode&&t&&this.getSensorStatus()},radio:function(){this.initData(),0!=this.selectedAgentsData.length&&this.getRebootPlan()}},computed:{total:function(){return this.success+this.installing+this.failed},options:function(){return[{value:1,label:this.$t("remoteControl.oneDay")},{value:7,label:this.$t("remoteControl.oneWeek")},{value:30,label:this.$t("remoteControl.oneMonth")},{value:90,label:this.$t("remoteControl.threeMonths")},{value:180,label:this.$t("remoteControl.sixMonths")},{value:365,label:this.$t("remoteControl.oneYear")}]}}},g={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isSingleMode,expression:"!isSingleMode"}],staticClass:"pluginsStatusContent p-r"},[s("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[s("el-tab-pane",{attrs:{name:"systemSetup"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"fa fa-wrench m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("remoteControl.systemSetup"))+"\n            ")]),t._v(" "),s("el-col",{staticClass:"m-t-20",attrs:{span:20}},[s("el-row",[s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkRed"},[s("i",{staticClass:"fa fa-undo info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.reboot")))])]),t._v(" "),s("el-button",{staticClass:"fa fa-undo",attrs:{circle:"",type:"danger",size:"small","aria-hidden":"true"},on:{click:function(e){t.batchSetup({reboot:!0},"reboot")}}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkViolet"},[s("i",{staticClass:"fa fa-power-off info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.shutdown")))])]),t._v(" "),s("el-button",{staticClass:"fa fa-power-off",attrs:{circle:"",type:"danger",size:"small","aria-hidden":"true"},on:{click:function(e){t.batchSetup({shutdown:!0},"shutdown")}}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-green"},[s("i",{staticClass:"fa fa-volume-up info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.audio")))])]),t._v(" "),s("el-slider",{staticClass:"counter",attrs:{min:0,max:100,step:1,"format-tooltip":t.handleAudio},on:{change:function(e){t.batchSetup({set_audio:t.audio},"audio")}},model:{value:t.audio,callback:function(e){t.audio=e},expression:"audio"}})],1)]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-Indigo"},[s("i",{staticClass:"fa fa-sun-o info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.brightness")))])]),t._v(" "),s("el-slider",{staticClass:"counter",attrs:{min:0,max:100,step:1,"format-tooltip":t.handleBrightness},on:{change:function(e){t.batchSetup({set_brightness:t.brightness},"brightness")}},model:{value:t.brightness,callback:function(e){t.brightness=e},expression:"brightness"}})],1)])],1)],1)],1),t._v(" "),s("el-tab-pane",{attrs:{name:"schedule"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"fa fa-calendar m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("remoteControl.schedule"))+"\n            ")]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkRed"},[s("i",{staticClass:"fa fa-undo info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.reboot")))])]),t._v(" "),s("div",{staticClass:"date"},[s("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v(t._s(t.$t("remoteControl.once")))]),t._v(" "),s("el-radio",{attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v(t._s(t.$t("remoteControl.repeat")))]),s("br"),t._v(" "),s("el-date-picker",{staticClass:"m-t-15",attrs:{type:"datetime",placeholder:t.$t("remoteControl.datetimeHolder")},model:{value:t.rebootDate,callback:function(e){t.rebootDate=e},expression:"rebootDate"}}),t._v(" "),2==t.radio?s("el-select",{staticClass:"m-t-15",attrs:{placeholder:t.$t("remoteControl.cycleHolder")},model:{value:t.cycle,callback:function(e){t.cycle=e},expression:"cycle"}},t._l(t.options,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})):t._e(),s("br"),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.batchScheduleReboot({reboot:!1},"reboot")}}},[t._v(t._s(t.$t("remoteControl.disable")))]),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.batchScheduleReboot({reboot:!0},"reboot")}}},[t._v(t._s(t.$t("remoteControl.save")))])],1)])]),t._v(" "),s("el-col",{staticClass:"pd-5",attrs:{md:8,sm:12}},[s("div",{staticClass:"info-box"},[s("span",{staticClass:"info-box-icon bg-DarkViolet"},[s("i",{staticClass:"fa fa-power-off info-box-icon-white"}),t._v(" "),s("p",{staticClass:"info-box-icon-title"},[t._v(t._s(t.$t("remoteControl.shutdown")))])]),t._v(" "),s("div",{staticClass:"date"},[s("el-date-picker",{staticClass:"m-t-30",attrs:{type:"datetime",placeholder:t.$t("remoteControl.datetimeHolder")},model:{value:t.shutdownDate,callback:function(e){t.shutdownDate=e},expression:"shutdownDate"}}),s("br"),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.batchScheduleShutdown({shutdown:!1},"shutdown")}}},[t._v(t._s(t.$t("remoteControl.disable")))]),t._v(" "),s("el-button",{staticClass:"m-t-15",attrs:{type:"primary",size:"small"},on:{click:function(e){t.batchScheduleShutdown({shutdown:!0},"shutdown")}}},[t._v(t._s(t.$t("remoteControl.save")))])],1)])])],1),t._v(" "),s("el-tab-pane",{attrs:{name:"batchSetupHistory"}},[s("span",{attrs:{slot:"label"},slot:"label"},[s("i",{staticClass:"fa fa-history m-r-5",attrs:{"aria-hidden":"true"}}),t._v("\n                "+t._s(t.$t("remoteControl.history"))+"\n            ")]),t._v(" "),s("plugins-history",{ref:"batchSetupHistory",attrs:{groupname:t.groupname},on:{isFinished:t.isFinished,getStatusCount:t.getBatchPluginsStatusCount}})],1)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.dialogTasknameVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogTasknameVisible=e},close:function(e){t.initTasknameInfo()}}},[s("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[s("i",{staticClass:"fa fa-level-up m-r-10"}),t._v("\n            "+t._s(t.$t("remoteControl.batchSystemSetup"))+"\n        ")]),t._v(" "),s("el-form",{ref:"batchSetupForm",attrs:{model:t.batchSetupForm,rules:t.rules}},[s("el-form-item",{attrs:{label:t.$t("label.taskName"),"label-width":"230px",prop:"taskname"}},[s("el-input",{staticClass:"max-w-350",attrs:{autocomplete:"off",placeholder:t.$t("remoteControl.batchSetupTaskName")},model:{value:t.batchSetupForm.taskname,callback:function(e){t.$set(t.batchSetupForm,"taskname","string"==typeof e?e.trim():e)},expression:"batchSetupForm.taskname"}})],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.dialogTasknameVisible=!1}}},[t._v(t._s(t.$t("global.cancel")))]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.systemSetupAction()}}},[t._v(t._s(t.$t("global.confirm")))])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowOverview,expression:"isShowOverview"}],staticClass:"pluginsStatusCount"},[s("span",[t._v(t._s(t.$t("label.taskName"))+" "+t._s(t.rm_taskname))]),t._v(" "),s("span",[t._v(t._s(t.$t("appControl.total"))+" "+t._s(t.total))]),t._v(" "),s("span",[t._v(t._s(t.$t("appControl.deploying"))+" "+t._s(t.installing))]),t._v(" "),s("span",[t._v(t._s(t.$t("appControl.success"))+" "+t._s(t.success))]),t._v(" "),s("span",[t._v(t._s(t.$t("appControl.failed"))+" "+t._s(t.failed))])])],1)},staticRenderFns:[]};var p=s("C7Lr")(m,g,!1,function(t){s("unQV")},"data-v-3d3cf900",null).exports,v=s("FM1y"),_={name:"remoteControl",data:function(){return{selectedAgentId:"",selectedAgentsData:[],isSingleMode:!0,groupname:"",isDisabledOffDev:!0,isOffline:!1}},components:{selectDevice:a.a,selectGroup:h.a,modeSwitch:v.a,singleControl:f,batchControl:p},methods:{getDeviceOption:function(t){this.selectedAgentId=t},getGroupOption:function(t){this.selectedAgentsData=t},initData:function(){this.selectedAgentId="",this.groupname="",this.selectedAgentsData=[]},changeMode:function(t){this.initData(),this.isSingleMode=!t},getGroupName:function(t){this.groupname=t},isDisabled:function(t){this.isDisabledOffDev=t},isOfflineDev:function(t){this.isOffline=t}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content-box"},[s("div",{staticClass:"title-box"},[s("p",{staticClass:"header-line"},[s("i",{staticClass:"fa fa-cogs m-r-10"}),t._v("\n            "+t._s(t.$t("home.remoteControl"))+"   \n        ")])]),t._v(" "),s("div",{staticClass:"select-box"},[s("mode-switch",{on:{"mode-status":t.changeMode}}),t._v(" "),s("span",{staticClass:"vertical"}),t._v(" "),s("select-group",{attrs:{isSingleMode:t.isSingleMode},on:{"select-getDeviceOptions":t.getGroupOption,"select-getGroupName":t.getGroupName}}),t._v(" "),s("select-device",{attrs:{isSingleMode:t.isSingleMode,isDisabledOffDev:t.isDisabledOffDev},on:{"select-device":t.getDeviceOption,isOfflineDev:t.isOfflineDev}})],1),t._v(" "),s("div",{staticClass:"table-box"},[s("single-control",{attrs:{selectedAgentId:t.selectedAgentId,isSingleMode:t.isSingleMode,isOffline:t.isOffline},on:{isDisabled:t.isDisabled}}),t._v(" "),s("batch-control",{attrs:{selectedAgentsData:t.selectedAgentsData,isSingleMode:t.isSingleMode,groupname:t.groupname}})],1)])},staticRenderFns:[]};var S=s("C7Lr")(_,C,!1,function(t){s("xPv9")},null,null);e.default=S.exports},l8Mf:function(t,e){},unQV:function(t,e){},xPv9:function(t,e){}});
//# sourceMappingURL=15.fd2c9c86d9a98c24b7f3.js.map